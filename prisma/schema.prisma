generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  uid                      String               @id @default(uuid())
  id                       String               @unique
  role                     String
  password                 String
  email                    String               @unique
  needs_password_change    Boolean?             @default(true)
  password_change_at       DateTime?            @default(now())
  created_at               DateTime             @default(now())
  updated_at               DateTime             @updatedAt
  admin_id                 String?
  admin                    Admin?               @relation(fields: [admin_id], references: [uid])
  customer_id              String?
  customer                 Customer?            @relation(fields: [customer_id], references: [uid])
  user_coupon_condition    UserCouponCondition? @relation(fields: [user_coupon_condition_id], references: [id])
  user_coupon_condition_id String?

  @@map("users")
}

model ManagementDepartment {
  id         String   @id @default(uuid())
  title      String   @unique
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
  admins     Admin[]

  @@map("management_departments")
}

model Customer {
  uid              String            @id @default(uuid())
  id               String            @unique
  name_id          String
  name             Name              @relation(fields: [name_id], references: [id])
  created_at       DateTime          @default(now())
  country          String?
  gender           String?
  date_of_birth    String?
  contact_no       String?
  profile_image    String?
  updated_at       DateTime          @updatedAt
  users            User[]
  customer_address CustomerAddress[]

  @@map("customers")
}

model Admin {
  uid                      String               @id @default(uuid())
  id                       String               @unique
  name_id                  String
  name                     Name?                @relation(fields: [name_id], references: [id])
  date_of_birth            String?
  gender                   String?
  blood_group              String?
  contact_no               String               @unique
  emergency_contact_no     String
  present_address          String
  permanent_address        String
  designation              String
  management_department_id String
  management_department    ManagementDepartment @relation(fields: [management_department_id], references: [id])
  profile_image            String?
  created_at               DateTime             @default(now())
  updated_at               DateTime             @updatedAt
  users                    User[]

  @@map("admins")
}

model Name {
  id          String     @id @default(uuid())
  first_name  String
  last_name   String
  middle_name String?
  admins      Admin[]
  customer    Customer[]
  created_at  DateTime   @default(now())
  updated_at  DateTime   @updatedAt

  @@map("names")
}

model Category {
  id             String    @id @default(uuid())
  name           String
  description    String
  status         Boolean
  include_in_nav Boolean
  parent_id      Int
  position       Int
  Meta_SEO       MetaSEO?  @relation(fields: [meta_SEO_id], references: [id])
  meta_SEO_id    String?
  images         Image[]
  products       Product[]
  created_at     DateTime  @default(now())
  updated_at     DateTime  @updatedAt
}

model MetaSEO {
  id               String     @id @default(uuid())
  parent_id        String
  meta_title       String
  meta_description String
  url_key          String
  categories       Category[]
  keywords         Keyword[]
  created_at       DateTime   @default(now())
  updated_at       DateTime   @updatedAt
  products         Product[]
  CMSs             CMS[]
}

model Keyword {
  id          String   @id @default(uuid())
  name        String
  Meta_SEO    MetaSEO? @relation(fields: [meta_SEO_id], references: [id])
  meta_SEO_id String?
  isDeleted   Boolean?
  created_at  DateTime @default(now())
  updated_at  DateTime @updatedAt
}

model Image {
  id          String    @id @default(uuid())
  image_url   String
  category    Category? @relation(fields: [category_id], references: [id])
  category_id String?
  product     Product?  @relation(fields: [product_id], references: [id])
  product_id  String?
  isDeleted   Boolean?
  created_at  DateTime  @default(now())
  updated_at  DateTime  @updatedAt
}

model AttributeGroup {
  id         String      @id @default(uuid())
  group_name String
  products   Product[]
  created_at DateTime    @default(now())
  updated_at DateTime    @updatedAt
  attributes Attribute[]
}

model Attribute {
  id                  String             @id @default(uuid())
  attribute_name      String
  attribute_code      String
  type                String
  is_required         Boolean
  display_on_frontend Boolean
  sort_order          Boolean
  is_filterable       Boolean
  created_at          DateTime           @default(now())
  updated_at          DateTime           @updatedAt
  attribute_group     AttributeGroup     @relation(fields: [attribute_group_id], references: [id])
  attribute_group_id  String
  attribute_options   AttributeOption[]
  productAttribute    ProductAttribute[]
}

model AttributeOption {
  id                    String                  @id @default(uuid())
  option_text           String
  attribute             Attribute?              @relation(fields: [attribute_id], references: [id])
  attribute_id          String
  is_deleted            Boolean?
  created_at            DateTime                @default(now())
  updated_at            DateTime                @updatedAt
  ProductAttributeValue ProductAttributeValue[]
}

model AttributeGroupCode {
  id                 String   @id @default(uuid())
  attribute_group_id String
  created_at         DateTime @default(now())
  updated_at         DateTime @updatedAt
}

model VarientGroup {
  id         String   @id @default(uuid())
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
}

model Product {
  id                 String             @id @default(uuid())
  name               String
  description        String
  short_description  String
  status             Boolean
  sku                String
  price              Float
  weight             Float
  qty                Int
  manage_stock       Int
  stock_availability Int
  tax_class          Boolean
  visibility         Boolean
  attribute_group    AttributeGroup?    @relation(fields: [attribute_group_id], references: [id])
  attribute_group_id String?
  category           Category?          @relation(fields: [category_id], references: [id])
  category_id        String?
  meta_SEO           MetaSEO            @relation(fields: [meta_SEO_id], references: [id])
  meta_SEO_id        String
  images             Image[]
  product_attributes ProductAttribute[]
  created_at         DateTime           @default(now())
  updated_at         DateTime           @updatedAt
  collections        Collection[]
  ProductID          ProductID[]
}

model ProductAttribute {
  id                    String                  @id @default(uuid())
  attribute             Attribute               @relation(fields: [attribute_id], references: [id])
  attribute_id          String
  product               Product?                @relation(fields: [product_id], references: [id])
  product_id            String?
  is_deleted            Boolean?
  created_at            DateTime                @default(now())
  updated_at            DateTime                @updatedAt
  ProductAttributeValue ProductAttributeValue[]
}

model ProductAttributeValue {
  id                   String           @id @default(uuid())
  productAttribute     ProductAttribute @relation(fields: [product_attribute_id], references: [id])
  product_attribute_id String
  attribute_option     AttributeOption  @relation(fields: [attribute_option_id], references: [id])
  attribute_option_id  String
  extra_price          Float
  is_deleted           Boolean?
  created_at           DateTime         @default(now())
  updated_at           DateTime         @updatedAt
}

// model ProductAttributeOption {
//   id                              String                        @id @default(uuid())
//   option_name                     String
//   option_type                     String
//   is_required                     Boolean
//   product                         Product?                      @relation(fields: [product_id], references: [id])
//   product_id                      String?
//   product_attribute_option_values ProductAttributeOptionValue[]
//   created_at                      DateTime                      @default(now())
//   updated_at                      DateTime                      @updatedAt
// }

// when user clicks on the addToCart button items will be added in the localStorage/cookie

model CustomerAddress {
  id           String      @id @default(uuid())
  type         AddressType
  addresses    Address[]
  created_at   DateTime    @default(now())
  updated_at   DateTime    @updatedAt
  Customer     Customer?   @relation(fields: [customer_Uid], references: [uid])
  customer_Uid String
}

model Address {
  id                  String           @id @default(uuid())
  full_name           String
  telephone           String
  address_1           String
  address_2           String
  city                String
  province            String
  country             String
  postcode            String
  customer_address    CustomerAddress? @relation(fields: [customer_address_id], references: [id])
  customer_address_id String?
  created_at          DateTime         @default(now())
  updated_at          DateTime         @updatedAt
}

model ShippingMethod {
  id          String   @id @default(uuid())
  method_name String
  method_code String
  created_at  DateTime @default(now())
  updated_at  DateTime @updatedAt
}

model PaymentMethod {
  id          String   @id @default(uuid())
  method_name String
  method_code String
  created_at  DateTime @default(now())
  updated_at  DateTime @updatedAt
}

model Coupon {
  id                         String                @id @default(uuid())
  status                     Boolean
  description                String
  discount_amount            Int
  free_shipping              Boolean
  discount_type              String
  coupon                     String
  used_time                  Int
  condition                  String
  user_condition             String
  buyx_gety                  String
  max_uses_time_per_coupon   String
  max_uses_time_per_customer String
  start_date                 String
  end_date                   String
  target_coupon_products     TargetCouponProduct[]
  created_at                 DateTime              @default(now())
  updated_at                 DateTime              @updatedAt
}

model TargetCouponProduct {
  id              String          @id @default(uuid())
  maxQTy          Int
  coupon_products CouponProduct[]
  coupon          Coupon?         @relation(fields: [coupon_id], references: [id])
  coupon_id       String?
  created_at      DateTime        @default(now())
  updated_at      DateTime        @updatedAt
}

model CouponProduct {
  id                       String               @id @default(uuid())
  key                      String
  operator                 String
  value                    String
  target_coupon_product    TargetCouponProduct? @relation(fields: [target_coupon_product_id], references: [id])
  target_coupon_product_id String?
  created_at               DateTime             @default(now())
  updated_at               DateTime             @updatedAt
}

model CouponCondition {
  id          String   @id @default(uuid())
  order_total Int
  order_qty   Int
  created_at  DateTime @default(now())
  updated_at  DateTime @updatedAt
}

model RequiredCouponProduct {
  id         String   @id @default(uuid())
  key        String
  operator   String
  qty        Int
  value      Int
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
}

model UserCouponCondition {
  id         String   @id @default(uuid())
  email      String
  parchased  Int
  users      User[]
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
}

model Order {
  id           String   @id @default(uuid())
  order_number Int
  created_at   DateTime @default(now())
  updated_at   DateTime @updatedAt
}

model CMS {
  id         String    @id @default(uuid())
  status     Boolean
  layout     CMSLayout
  name       String
  content    String
  created_at DateTime  @default(now())
  updated_at DateTime  @updatedAt
  MetaSEO    MetaSEO?  @relation(fields: [metaSEOId], references: [id])
  metaSEOId  String?
}

model Collection {
  id              String      @id @default(uuid())
  collection_name String
  collection_code String
  description     String
  products        Product[]
  created_at      DateTime    @default(now())
  updated_at      DateTime    @updatedAt
  ProductID       ProductID[]
}

model ProductID {
  id           String     @id @default(uuid())
  product      Product    @relation(fields: [productId], references: [id])
  productId    String
  collection   Collection @relation(fields: [collectionId], references: [id])
  collectionId String
}

enum AddressType {
  home
  office
}

enum CMSLayout {
  onColumn
  twoColumnsLeft
  twoColumnsRight
  threeColumns
}
